function reasonsChanged(){str=document.kbank_form_the_form.reasons.value;if(str!="other"){part=str.split(":");points=part[0];reason=part[1];if(points!=0){document.kbank_form_the_form.points.value=points}document.kbank_form_the_form.reason.value=reason}else{document.kbank_form_the_form.reason.value=""}try{if(document.kbank_form_the_form.userid.type!="hidden"){document.kbank_form_the_form.userid.value=0}}finally{}}function createSubmitLink(a){if(fetch_object(a)){YAHOO.util.Event.on(fetch_object(a),"click",submit_click)}}function submit_click(a){if(!this.worker||this.worker.waitingNext){YAHOO.util.Event.stopEvent(a);if(!this.worker){this.worker=new vB_AJAX_Worker(this.id)}this.worker.do_post()}else{if(this.worker.workdone){self.close()}}}function vB_AJAX_Worker(a){this.postid=post_postid;this.button_id=a;this.the_button=fetch_object(a);this.the_form=fetch_object(a+"_the_form");this.progress=fetch_object(a+"_progress");this.message_area=fetch_object(a+"_message");this.do_ajax_submit=true}vB_AJAX_Worker.prototype.do_post=function(){this.waitingNext=false;this.workdone=false;if(this.do_ajax_submit){var a=new vB_Hidden_Form(null);a.add_variables_from_object(this.the_form);YAHOO.util.Connect.asyncRequest("POST",this.the_form.action,{success:this.handle_ajax_submit,failure:this.handle_ajax_submit_error,timeout:vB_Default_Timeout,scope:this},SESSIONURL+"ajax=1&"+a.build_query_string());if(this.progress){this.progress.style.display=""}if(this.the_button){this.the_button.disabled=true}}};vB_AJAX_Worker.prototype.handle_ajax_submit=function(f){if(f.responseXML){var a=f.responseXML.getElementsByTagName("error");if(a.length){this.waitingNext=true;alert(a[0].firstChild.nodeValue)}else{var e=f.responseXML.getElementsByTagName("product");var d=f.responseXML.getElementsByTagName("box");var b=f.responseXML.getElementsByTagName("button");var c=f.responseXML.getElementsByTagName("message");if(e.length&&e[0].firstChild&&e[0].firstChild.nodeValue=="kbank_award"){if(window.opener&&window.opener.document.getElementById("kbank_award_box_"+this.postid)){if(d.length&&d[0].firstChild&&d[0].firstChild.nodeValue!==""){window.opener.document.getElementById("kbank_award_box_"+this.postid).innerHTML=d[0].firstChild.nodeValue}else{window.opener.document.getElementById("kbank_award_box_"+this.postid).innerHTML=""}}if(window.opener&&window.opener.document.getElementById("kbank_award_button_"+this.postid)){if(b.length&&b[0].firstChild&&b[0].firstChild.nodeValue!==""){window.opener.document.getElementById("kbank_award_button_"+this.postid).innerHTML=b[0].firstChild.nodeValue}else{window.opener.document.getElementById("kbank_award_button_"+this.postid).innerHTML=""}}if(this.message_area){if(c.length&&c[0].firstChild&&c[0].firstChild.nodeValue!==""){this.message_area.innerHTML=c[0].firstChild.nodeValue}else{this.message_area.innerHTML=""}}}this.workdone=true;this.the_button.value="Close"}}if(this.progress){this.progress.style.display="none"}if(this.the_button){this.the_button.disabled=false}};vB_AJAX_Worker.prototype.handle_ajax_submit_error=function(a){vBulletin_AJAX_Error_Handler(a);this.do_ajax_submit=false;the_form.submit()};